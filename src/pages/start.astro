---
import BaseLayout from "../layouts/BaseLayout.astro";
import NavBar from "../components/NavBar.astro";
import Section from "../components/Section.astro";
import TagPills from "../components/TagPills.astro";
import Card from "../components/Card.astro";
import { getCollection } from "astro:content";

const mustTag = "å…¥å‘å¿…çœ‹";
const clips = (await getCollection("clips")).filter((x) => x.data.tags.includes(mustTag)).slice(0, 6);
const fanworks = (await getCollection("fanworks")).filter((x) => x.data.tags.includes(mustTag)).slice(0, 6);
---
<BaseLayout title="å…¥å‘ï½œé—ªè€€èˆå°" description="æ–°ç²‰è·¯çº¿ï¼šå…ˆçœ‹ä»€ä¹ˆã€å†çœ‹ä»€ä¹ˆã€è¡¥è¯¾æ¸…å•">
  <NavBar slot="nav" active="start" />

  <h1 class="h1">æ–°ç²‰å…¥å‘è·¯çº¿ ğŸ§­</h1>

  <Section title="å…ˆè®¤è¯†å¥¹ä»¬">
    <div class="grid cols-2">
      <Card href="/members/fiona" title="Fionaï¼ˆå¿ƒå®œï¼‰" desc="æˆå‘˜é¡µï¼šå…³é”®è¯ã€é£æ ¼ã€æ¨èè§‚çœ‹æ¸…å•ã€å¸¸ç”¨é“¾æ¥ã€‚" icon="ğŸ«§" />
      <Card href="/members/gladys" title="Gladysï¼ˆæ€è¯ºï¼‰" desc="æˆå‘˜é¡µï¼šå…³é”®è¯ã€é£æ ¼ã€æ¨èè§‚çœ‹æ¸…å•ã€å¸¸ç”¨é“¾æ¥ã€‚" icon="ğŸŒ™" />
    </div>
  </Section>

  <Section title="å…ˆçœ‹ 6 æ¡â€œå…¥å‘å¿…çœ‹â€">
    <p class="p" style="margin-bottom: 10px;">æ¥è‡ªç²¾é€‰åº“ï¼ˆåˆ‡ç‰‡ + äºŒåˆ›ï¼‰ä¸­æ ‡è®°äº† <span class="kbd">#{mustTag}</span> çš„æ¡ç›®ã€‚</p>

    <div class="grid cols-3">
      {[...clips, ...fanworks].slice(0, 6).map((r) => (
        <a class="rec" href={r.data.url} target="_blank" rel="noreferrer">
          <div class="t">{r.data.title}</div>
          <div class="d">{r.data.reason ?? ""}</div>
          <div class="meta">
            <span class="pill">{r.data.member}</span>
            <span class="pill faint">{r.collection}</span>
          </div>
          <TagPills tags={r.data.tags.slice(0, 4)} />
        </a>
      ))}
    </div>

    {!clips.length && !fanworks.length && (
      <p class="p">ä½ è¿˜æ²¡æ ‡æ³¨ â€œå…¥å‘å¿…çœ‹â€ çš„æ¨èæ¡ç›®ã€‚å» src/content/clips æˆ– fanworks é‡Œç»™ tags åŠ ä¸Šå®ƒå³å¯ã€‚</p>
    )}
  </Section>

  <Section title="åƒå…‹å…¥å‘å¿…çœ‹">
    <p class="p">
      ä½ å¯ä»¥æŠŠæœ¬ç«™å½“æˆæ¯å‘¨å…¥å£ï¼šå…ˆçœ‹ <a class="inline" href="/schedule">æ’ç­</a>ï¼Œç›´æ’­ç»“æŸåè¡¥ <a class="inline" href="/streams">è®°å½•</a>ï¼Œ
      çœ‹åˆ°å¥½åˆ‡ç‰‡/äºŒåˆ›å°±ä¸¢è¿› <a class="inline" href="/library">ç²¾é€‰åº“</a>ï¼Œå‘¨æœ«é¡ºæ‰‹è®°ä¸€ä¸‹ <a class="inline" href="/stats">ç²‰ä¸æ•°å¿«ç…§</a>ã€‚
    </p>
  </Section>

  <style lang="scss">
  @use "../styles/mixins" as m;

  .rec{
    @include m.glass;
    @include m.hover-float;
    border-radius: var(--r-lg);
    padding: 14px 14px;
    display: block;
  }
  .t{ font-weight: 700; margin-bottom: 6px; }
  .d{ color: rgba(255,255,255,.65); font-size: 13px; min-height: 34px; }
  .meta{ display:flex; gap: 8px; flex-wrap: wrap; margin: 10px 0 8px; }
  .pill{
    padding: 4px 8px;
    border-radius: 999px;
    font-size: 12px;
    border: 1px solid rgba(255,255,255,.12);
    background: rgba(0,0,0,.18);
    color: rgba(255,255,255,.78);
  }
  .pill.faint{ color: rgba(255,255,255,.62); }
  .inline{
    color: rgba(255,255,255,.86);
    text-decoration: underline;
    text-decoration-color: rgba(255,255,255,.28);
    text-underline-offset: 3px;
  }
  </style>
</BaseLayout>
